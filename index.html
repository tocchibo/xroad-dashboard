<!DOCTYPE html>







<html lang="ja">







  <head>







    <meta charset="UTF-8" />







    <meta name="viewport" content="width=device-width, initial-scale=1.0" />







    <title>自治体橋梁ダッシュボード</title>







    <meta name="description" content="自治体の橋梁データをブラウザだけで可視化できるダッシュボード" />







    <link rel="preconnect" href="https://fonts.googleapis.com" />







    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />







    <link







      href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&display=swap"







      rel="stylesheet"







    />







    <link







      rel="icon"







      type="image/svg+xml"







      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' rx='6' fill='%230068d6'/%3E%3Cpath d='M8 21h16v-2H8zm0-4h16v-2H8zm0-4h16V11H8z' fill='white'/%3E%3C/svg%3E"







    />







    <link rel="stylesheet" href="css/styles.css" />







    <link







      rel="stylesheet"







      href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css"







      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="







      crossorigin=""







    />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css"
    />













    <link







      rel="stylesheet"













    />







    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.fullscreen@2.4.0/Control.FullScreen.css" />







    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js" defer></script>







    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js" defer></script>







    <script







      src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js"







      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="







      crossorigin=""







      defer







    ></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js" defer></script>













    <script src="https://cdn.jsdelivr.net/npm/leaflet.fullscreen@2.4.0/Control.FullScreen.js" defer></script>







    <script src="js/main.js" defer></script>







  </head>







  <body>







    <div class="app-shell">







      <header class="app-header">







        <div class="header-primary">







          <h1>自治体橋梁ダッシュボード</h1>







          <p class="lead">







            自治体ごとの橋梁施設一覧 CSV を読み込むだけで、ストック構成・健全度・橋長や架設年度の傾向、地図上での配置をまとめて確認できる







            クライアントサイドアプリです。データはブラウザ内で完結し、複数自治体の状況を安全に比較できます。







          </p>







        </div>







      </header>















      <main class="app-main">
        <button
          type="button"
          class="drawer-toggle"
          data-filter-drawer-toggle
          aria-controls="filter-drawer-panel"
          aria-expanded="false"
          aria-label="データ＆フィルタを開閉"
        >
          <span class="hamburger" aria-hidden="true">
            <span></span>
            <span></span>
            <span></span>
          </span>
          <span class="drawer-toggle-text">データ＆フィルタ</span>
        </button>























        















        <section class="chart-grid" aria-label="グラフエリア">







          <article class="panel card chart-card" aria-labelledby="stock-chart-title">







            <div class="panel-header">







              <div>







                <h3 id="stock-chart-title">橋種別ストック構成</h3>







              </div>







              <div class="chart-controls">







                <label class="select-label">







                  指標:







                  <select data-stock-mode>







                    <option value="count">橋梁数</option>







                    <option value="length">総延長</option>







                  </select>







                </label>







                <label class="select-label">







                  集計:







                  <select data-stock-scope>







                    <option value="bridgeType">橋種別</option>







                    <option value="dataset">自治体別</option>







                  </select>







                </label>







                <span class="chart-filter-note" data-culvert-hint hidden>カルバートを除く</span>







              </div>







            </div>







            <div class="chart-placeholder">







              <canvas id="chart-stock" aria-label="橋種別ストック構成"></canvas>







            </div>







          </article>















          <article class="panel card chart-card" aria-labelledby="rating-chart-title">







            <div class="panel-header">







              <div>







                <h3 id="rating-chart-title">点検判定区分の分布</h3>







              </div>







              <div class="chart-controls">







                <span class="chart-filter-note" data-culvert-hint hidden>カルバートを除く</span>







              </div>







            </div>







            <div class="chart-placeholder">







              <canvas id="chart-rating" aria-label="点検判定区分の分布"></canvas>







            </div>







          </article>















          <article class="panel card chart-card" aria-labelledby="length-chart-title">







            <div class="panel-header">







              <div>







                <h3 id="length-chart-title">橋長階級ヒストグラム</h3>







              </div>







              <div class="chart-controls">







                <div class="chart-range-inline">







                  <label class="range-inline-control">







                    階級幅:







                    <input







                      type="range"







                      min="5"







                      max="50"







                      step="5"







                      value="10"







                      data-length-bin-range







                      aria-label="橋長階級幅"







                    />







                    <span class="range-inline-value" data-length-bin-label aria-live="polite">10 m</span>







                  </label>







                </div>







                <span class="chart-filter-note" data-culvert-hint hidden>カルバートを除く</span>







              </div>







            </div>







            <div class="chart-placeholder">







              <canvas id="chart-length" aria-label="橋長階級ヒストグラム"></canvas>







            </div>







          </article>















          <article class="panel card chart-card" aria-labelledby="year-chart-title">







            <div class="panel-header">







              <div>







                <h3 id="year-chart-title">架設年度分布</h3>







              </div>







              <div class="chart-controls">







                <label class="select-label">







                  粒度:







                  <select data-year-grouping>







                    <option value="decade">10 年階級</option>







                    <option value="year">1 年</option>







                  </select>







                </label>







                <span class="chart-filter-note" data-culvert-hint hidden>カルバートを除く</span>







              </div>







            </div>







            <div class="chart-placeholder">







              <canvas id="chart-year" aria-label="架設年度分布"></canvas>







            </div>







          </article>















          <article class="panel card chart-card" aria-labelledby="pc-tension-chart-title">







            <div class="panel-header">







              <div>







                <h3 id="pc-tension-chart-title">PC橋の張力方式別構成</h3>







              </div>







              <div class="chart-controls">







                <span class="chart-filter-note" data-culvert-hint hidden>カルバートを除く</span>







              </div>







            </div>







            <div class="chart-placeholder">







              <canvas id="chart-pc-tension" aria-label="PC橋の張力方式別構成"></canvas>







            </div>







          </article>















          <article class="panel card chart-card" aria-labelledby="pc-post-chart-title">







            <div class="panel-header">







              <div>







                <h3 id="pc-post-chart-title">ポステンPC橋の形式内訳</h3>







              </div>







              <div class="chart-controls">







                <span class="chart-filter-note" data-culvert-hint hidden>カルバートを除く</span>







              </div>







            </div>







            <div class="chart-placeholder">







              <canvas id="chart-pc-post" aria-label="ポステンPC橋の形式内訳"></canvas>







            </div>







          </article>







        </section>















        <section class="panel card map-panel" aria-labelledby="map-heading">







          <div class="panel-header">







            <div>







              <h2 id="map-heading">地理的分布</h2>







            </div>







            <div class="map-controls" aria-label="&#22320;&#22259;&#12398;&#12503;&#12525;&#12483;&#12488;&#34920;&#31034;&#35373;&#23450;">



              <div class="map-control-block">



                <p class="map-control-label">&#12503;&#12525;&#12483;&#12488;&#12469;&#12452;&#12474;</p>



                <div class="range-display">



                  <span>&#23567;</span>



                  <input



                    type="range"



                    min="-50"



                    max="50"



                    step="5"



                    value="0"



                    data-marker-size-range



                    aria-label="&#22320;&#22259;&#19978;&#12398;&#12510;&#12540;&#12459;&#12540;&#12469;&#12452;&#12474;"



                  />



                  <span>&#22823;</span>



                </div>



              </div>



              <div class="map-control-block">



                <p class="map-control-label" id="base-layer-label">&#12505;&#12540;&#12473;&#12510;&#12483;&#12503;&#20999;&#12426;&#26367;&#12360;</p>



                <select class="map-layer-select" data-base-layer aria-labelledby="base-layer-label">



                  <option value="standard">OpenStreetMap &#27161;&#28310;</option>



                  <option value="positron">CartoDB Positron</option>



                  <option value="darkmatter">CartoDB Dark Matter</option>



                </select>






              </div>
              <div class="map-control-block" data-cluster-block>
                <p class="map-control-label">&#12463;&#12521;&#12473;&#12479;&#34920;&#31034;</p>
                <label class="checkbox-control">
                  <input type="checkbox" data-map-cluster-toggle />
                  <span>&#23494;&#38598;&#31623;&#25152;&#12434;&#12463;&#12521;&#12473;&#12479;&#34920;&#31034;</span>
                </label>
              </div>



            </div>







          </div>







          <div class="map-canvas" id="map" role="img" aria-label="橋梁マップ"></div>







          <p class="map-info">







            表示中の橋梁: <strong data-map-count>0</strong> 件 /







            緯度経度欠損: <strong data-map-missing>0</strong> 件







            <span class="chart-filter-note" data-culvert-hint hidden>カルバートを除く</span>







          </p>







          <div class="map-legends">







            <div>







              <p class="legend-title">点検判定区分</p>







              <ul class="legend-list">







                <li><span class="legend-swatch swatch-i"></span>I（健全）</li>







                <li><span class="legend-swatch swatch-ii"></span>II（予防保全）</li>







                <li><span class="legend-swatch swatch-iii"></span>III（早期措置）</li>







                <li><span class="legend-swatch swatch-iv"></span>IV（緊急措置）</li>







                <li><span class="legend-swatch swatch-unknown"></span>不明</li>







              </ul>







            </div>







            <div>







              <p class="legend-title">橋種カテゴリ</p>







              <ul class="legend-list">







                <li><span class="legend-shape marker-shape-pc"></span>PC 橋</li>







                <li><span class="legend-shape marker-shape-rc"></span>RC 橋</li>







                <li><span class="legend-shape marker-shape-steel"></span>鋼橋</li>







                <li><span class="legend-shape marker-shape-other"></span>その他</li>







              </ul>







            </div>







          </div>







        </section>











      </main>

      <aside
        class="filter-drawer"
        data-filter-drawer
        id="filter-drawer-panel"
        aria-label="データ＆フィルタ"
        aria-hidden="true"
      >
        <div class="filter-drawer-inner">
          <header class="filter-drawer-header">
            <div>
              <p class="eyebrow">操作メニュー</p>
              <h2>データ＆フィルタ</h2>
            </div>
            <button
              type="button"
              class="filter-drawer-close"
              data-filter-drawer-close
              aria-label="ドロワーを閉じる"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </header>
          
          <section class="panel card drawer-card loader-panel ingest-panel" aria-label="CSV 読み込みと dataset">
            <div class="ingest-grid">
              <section class="ingest-column ingest-upload" aria-labelledby="csv-loader-heading">
                <h3 class="ingest-subtitle" id="csv-loader-heading">CSV 読み込み</h3>
                <div class="dropzone" data-dropzone tabindex="0">
                  <div class="dropzone-inner">
                    <p class="dropzone-title">ここに CSV をドラッグ &amp; ドロップ</p>
                  </div>
                </div>
                <div class="loader-controls">
                  <label class="file-input-button">
                    <input type="file" accept=".csv,text/csv" multiple data-file-input />
                    <span>CSV ファイルを選択</span>
                  </label>
                </div>
              </section>
              <section class="ingest-column ingest-datasets" aria-labelledby="dataset-heading">
                <h3 class="ingest-subtitle" id="dataset-heading">読み込み済み dataset</h3>
                <p class="dataset-empty" data-dataset-empty>dataset はまだありません。CSV を取り込むとここに一覧が表示されます。</p>
                <ul class="dataset-list" data-dataset-list aria-live="polite"></ul>
              </section>
            </div>
          </section>
          <section class="panel card drawer-card kpi-panel" aria-label="KPI ハイライト">
            <div class="kpi-grid">
              <div class="kpi-card">
                <p class="kpi-label">アクティブ dataset</p>
                <p class="kpi-value" data-kpi="datasets">0</p>
              </div>
              <div class="kpi-card">
                <p class="kpi-label">橋梁総数</p>
                <p class="kpi-value" data-kpi="bridges">0</p>
              </div>
              <div class="kpi-card">
                <p class="kpi-label">総延長 (km)</p>
                <p class="kpi-value" data-kpi="length">0.0</p>
              </div>
              <div class="kpi-card">
                <p class="kpi-label">要注視！ III/IV</p>
                <p class="kpi-value" data-kpi="flagged">0</p>
              </div>
            </div>
            <p class="kpi-note" data-kpi-culvert-hint hidden>カルバートを除外中</p>
          </section>
          <section class="panel card filter-panel" aria-labelledby="filter-heading">
            <div class="panel-header panel-header-tight">
              <div>
                <h2 id="filter-heading">データ＆フィルタ</h2>
              </div>
            </div>
            <div class="filter-row">
              <div class="filter-section">
                <p class="filter-label">橋種カテゴリ</p>
                <div class="chip-group" role="group" aria-label="橋種フィルタ" data-filter-bridge-types></div>
              </div>
              <div class="filter-section">
                <p class="filter-label">点検判定区分</p>
                <div class="chip-group" role="group" aria-label="点検判定フィルタ" data-filter-inspections></div>
              </div>
              <div class="filter-section filter-section-toggle">
                <p class="filter-label">表示設定</p>
                <label class="checkbox-control">
                  <input type="checkbox" data-filter-exclude-culvert />
                  <span>カルバートを除く</span>
                </label>
              </div>
            </div>
            <div class="pc-filter-stack" aria-labelledby="pc-filter-heading" aria-describedby="pc-filter-note">
              <div class="pc-filter-header">
                <div class="pc-filter-actions">
                  <button
                    type="button"
                    class="pc-filter-toggle"
                    data-pc-filter-toggle
                    aria-expanded="false"
                  >
                    PC橋詳細フィルタを表示
                  </button>
                  <button type="button" class="ghost-link" data-pc-filter-reset>リセット</button>
                </div>
              </div>
              <p class="filter-helper pc-filter-description">
                PC橋を軸に、張力方式（プレテン / ポステン / 不明）とポステン形式（中空床版 / T桁 / 箱桁 / その他）を段階的に絞り込めます。
              </p>
              <div class="pc-filter-body" data-pc-filter-body hidden>
                <div class="pc-filter-grid">
                  <section class="pc-filter-card" aria-labelledby="pc-tension-heading">
                    <div class="pc-filter-card-header">
                      <h3 id="pc-tension-heading">張力方式</h3>
                      <p>PC橋カテゴリをONにした際に操作できます。</p>
                    </div>
                    <div class="chip-group chip-group-nested" role="group" aria-label="張力方式フィルタ" data-filter-pc-tension></div>
                  </section>
                  <section class="pc-filter-card" aria-labelledby="pc-post-heading">
                    <div class="pc-filter-card-header">
                      <h3 id="pc-post-heading">ポステン形式</h3>
                      <p>張力方式でポステンを選んだ時のみ操作できます。</p>
                    </div>
                    <div class="chip-group chip-group-nested" role="group" aria-label="ポステン形式フィルタ" data-filter-pc-post></div>
                  </section>
                </div>
              </div>
            </div>
            <button type="button" class="filter-info-button" data-filter-info-open>フィルター条件の詳細</button>
          </section>
        </div>
      </aside>
      <div class="filter-drawer-backdrop" data-filter-drawer-backdrop hidden></div>
      <div class="modal-backdrop" data-filter-info-backdrop hidden></div>
      <section
        class="modal filter-info-modal"
        data-filter-info-modal
        aria-hidden="true"
        role="dialog"
        aria-labelledby="filter-info-title"
        hidden
      >
        <div class="modal-content">
          <header class="modal-header">
            <div>
              <p class="eyebrow">フィルター説明</p>
              <h2 id="filter-info-title">フィルター条件の詳細</h2>
            </div>
            <button type="button" class="modal-close" data-filter-info-close aria-label="詳細を閉じる">
              <span aria-hidden="true">&times;</span>
            </button>
          </header>
          <div class="modal-body">
            <section>
              <h3>橋種カテゴリ</h3>
              <p class="filter-info-summary">CSV の橋種関連列から PC/RC/鋼/その他のカテゴリを決定し、橋種チップで表示・非表示を切り替えます。</p>
              <dl class="filter-info-table">
                <dt>参照列</dt>
                <dd><code>上部工（使用材料）</code>（派生名を含む）&nbsp;/&nbsp;<code>上部構造形式</code>&nbsp;/&nbsp;<code>上部工（構造形式）</code></dd>
                <dt>判定順序</dt>
                <dd>
                  <ol class="filter-info-steps">
                    <li><code>上部工（使用材料）</code> の値にキーワードがあれば、そのカテゴリを採用。</li>
                    <li>空欄の場合は <code>上部構造形式</code> → <code>上部工（構造形式）</code> の順に同じキーワードを検索。</li>
                    <li>いずれにも一致しない場合は「その他」として扱う。</li>
                  </ol>
                </dd>
                <dt>主要キーワード</dt>
                <dd>
                  <ul class="filter-info-list">
                    <li>PC橋: “PC”“ＰＣ”“PRC”“ＰＲＣ”“プレストレスト”“ポストテンション” など。</li>
                    <li>RC橋: “RC”“ＲＣ”“鉄筋”“鉄筋コンクリート” など。</li>
                    <li>鋼橋: “鋼”“Ｓ造”“スチール”“トラス”“鋼桁”“鋼構造” など。</li>
                  </ul>
                </dd>
              </dl>
            </section>
            <section>
              <h3>点検判定区分</h3>
              <p class="filter-info-summary">CSV の判定区分を正規化して I〜IV/不明 のカテゴリにまとめ、該当チップで表示対象を制御します。</p>
              <dl class="filter-info-table">
                <dt>参照列</dt>
                <dd><code>点検記録_判定区分</code></dd>
                <dt>処理</dt>
                <dd>
                  <ol class="filter-info-steps">
                    <li>値をトリムし、全角ローマ数字・全角数字を半角に変換。</li>
                    <li>I/II/III/IV/1/2/3/4 のいずれかに一致した場合のみ該当カテゴリへ分類。</li>
                    <li>上記に該当しない値や空欄は “不明” として集計。</li>
                  </ol>
                </dd>
              </dl>
            </section>
            <section>
              <h3>PC橋詳細</h3>
              <p class="filter-info-summary">PC 橋のみ、張力方式とポステン形式で追加フィルタを提供します。</p>
              <dl class="filter-info-table">
                <dt>参照列</dt>
                <dd><code>上部構造形式</code>&nbsp;/&nbsp;<code>上部工（構造形式）</code>&nbsp;/&nbsp;<code>上部工（使用材料）</code></dd>
                <dt>張力方式（プレテン / ポステン / 不明）</dt>
                <dd>
                  <ul class="filter-info-list">
                    <li>“ポステン”“ポストテンション” などを含む → <code>ポステン</code></li>
                    <li>“プレテン”“プリテン” などを含む → <code>プレテン</code></li>
                    <li>上記以外 → <code>不明</code></li>
                  </ul>
                </dd>
                <dt>ポステン形式（中空床版 / T桁 / 箱桁 / その他）</dt>
                <dd>
                  <ul class="filter-info-list">
                    <li>張力方式が <code>ポステン</code> の場合のみ判定。</li>
                    <li>“中空床版” → 中空床版 ／ “T桁” → T桁 ／ “箱桁” → 箱桁 ／ それ以外 → その他。</li>
                  </ul>
                </dd>
                <dt>注意</dt>
                <dd>「PC橋」カテゴリをオフにすると、張力方式・ポステン形式のチップは自動的に無効になります。</dd>
              </dl>
            </section>
            <section>
              <h3>カルバート除外</h3>
              <p class="filter-info-summary">カルバート扱いのレコードを一括で除外できます。</p>
              <dl class="filter-info-table">
                <dt>参照列</dt>
                <dd><code>溝橋(ｶﾙﾊﾞｰﾄ)</code>&nbsp;/&nbsp;<code>上部構造形式</code>&nbsp;/&nbsp;<code>上部工（構造形式）</code></dd>
                <dt>判定ルール</dt>
                <dd>
                  <ol class="filter-info-steps">
                    <li><code>溝橋(ｶﾙﾊﾞｰﾄ)</code> 列が “○” または “●” → カルバート。</li>
                    <li>上記以外で形式名に “カルバート”“溝橋”“BOXカルバート” 等を含む場合もカルバート扱い。</li>
                  </ol>
                </dd>
                <dt>挙動</dt>
                <dd>「カルバートを除く」をオンにすると、該当レコードはグラフ・統計・地図・KPI すべてから除外されます。</dd>
              </dl>
            </section>
            <section>
              <h3>dataset 表示</h3>
              <p class="filter-info-summary">読み込んだ CSV（=dataset）単位で表示を切り替えます。</p>
              <dl class="filter-info-table">
                <dt>操作内容</dt>
                <dd>dataset カードのスイッチで ON/OFF を切り替え。OFF にした dataset のレコードは集計・地図・フィルタ・カルバート判定など全ての処理から除外されます。</dd>
              </dl>
            </section>
          </div>
        </div>
      </section>















      <footer class="app-footer">







        <p>自治体橋梁ダッシュボード — ローカル CSV を安全に可視化</p>







      </footer>







    </div>







  </body>







</html>







